<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boolzapp 4</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.9.8/dayjs.min.js' integrity='sha512-kZ+x2gdehn6OZMWZSp3Vt5R+v9hQTYEATQwaUfWquhxbvNVAy6IRtYs7asdyxKUTqG0I5ZqBqnzcBrpnHJCAGw==' crossorigin='anonymous'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.9.8/plugin/customParseFormat.min.js'
            integrity='sha512-/rAikt6xZJcTqu7olN/2DFvqXDEUC31/yyFAYrSGi087R+j54QTWWRJxHtbN5NjppOxT3d1gk4ZwkPWX88W35w==' crossorigin='anonymous'></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="bg-position"></div>

    <div id="app">

        <!-- container principale -->
        <div class="container container-app mx-auto d-flex">

            <!-- lato sinistro -->
            <div class="contacts-content d-flex flex-column">

                <!-- user bar -->
                <div class="user-bar d-flex justify-content-between flex-shrink-0">
                    <div>
                        <div class="d-flex img-size-bar">
                            <img src="../img/avatar_io.jpg" alt="Avatar Sofia" class="rounded-circle">
                            <div class="my-auto">Sofia</div>
                        </div>
                    </div>
                    <div class="user-nav d-flex my-auto">
                        <i class="fa-solid fa-circle-notch px-2"></i>
                        <i class="fa-solid fa-message px-2"></i>
                        <i class="fa-solid fa-ellipsis-vertical px-2"></i>
                    </div>
                </div>

                <!-- bar notifiche -->
                <div class="notice d-flex flex-shrink-0 p-2">

                    <div class="bg-bell d-flex justify-content-center align-items-center me-2">
                        <i class="fa-solid fa-bell-slash text-primary"></i>
                    </div>
                    <div>
                        <div class="display-7">Ricevi notifiche di nuovi messaggi</div>
                        <div><a href="#" class="text-secondary display-7">Attiva notifiche desktop</a></div>
                    </div>
                    
                </div>


                <!-- ricerca chat -->
                <div class="p-1">
                    <div class="input-group mb-1">
                        <button class="btn btn-outline-secondary px-4" type="button" id="button-addon1"><i class="fa-solid fa-magnifying-glass"></i></button>
                        <input type="text" class="form-control display-7" placeholder="Cerca o inizia una nuova chat" aria-label="Example text with button addon" aria-describedby="button-addon1" v-model="search">
                    </div>
                </div>


                <!-- lista contatti -->
                <div class="d-flex flex-grow-1 overflow-auto">
                    <ul class="list-unstyled w-100">
                        <li v-for="(contact, i) in searchContact()" 
                            @click="setActiveContact(contact)" :class="{'my-active': activeContact.avatar === contact.avatar}"
                            >
                            <div class="d-flex p-2 border-bottom border-light pointer">
                                <div class="flex-shrink-0 px-2">
                                    <div class="img-size">
                                        <img :src="'../img/avatar' + contact.avatar + '.jpg'" :alt="'Avatar ' + contact.name" class="w-100 rounded-circle" @click="setActiveContact(contact)">
                                    </div>
                                </div>
                            
                                <div class="d-flex flex-grow-1">
                                    <div class="text">
                                        <div>{{contact.name}}</div>
                                        <div class="text-black-50 display-7">Ultimo messaggio inviato</div>
                                    </div>
                                </div>
                                <div class="flex-shrink-0 display-7 text-black-50">17.28</div>
                                
                            </div>
                        </li>
                    </ul>
                </div>

            </div>

            <!-- main content -->
            <div class="main-content d-flex flex-column">


                <!-- barra superiore destra -->
                <div class="user-bar d-flex justify-content-between flex-shrink-0 border-start border-light">
                    
                        <div class="d-flex">
                            <img :src="'../img/avatar' + activeContact.avatar + '.jpg'" :alt="'Avatar ' + activeContact.name" class="img-size-bar rounded-circle">
                            <div class="my-auto ps-2">
                                <div>{{ activeContact.name }}</div>
                                <div class="display-7 text-black-50">Ultimo accesso oggi alle 17.44</div>
                            </div>
                        </div>
                    
                    <div class="user-nav d-flex my-auto">
                        <i class="fa-solid fa-magnifying-glass px-2"></i>
                        <i class="fa-solid fa-paperclip px-2"></i>
                        <i class="fa-solid fa-ellipsis-vertical px-2"></i>
                    </div>
                </div>

                <!-- chat section -->
                <div class="chat-section flex-grow-1 overflow-auto p-5">
                    <div class="d-flex flex-column" v-for="message in activeContact.messages">
                        <div class="message rounded p-3 my-2 position-relative" :class="{'message-received' : message.status === 'received',
                                                                                        'message-sent' : message.status === 'sent'}"> 
                            <div>{{ message.message }}</div>
                            <div class="text-position">{{ formatDate(message.date) }}</div>

                        </div>
                    </div>
                </div>

                <!-- barra inferiore -->
                <div class="d-flex flex-shrink-0 user-bar text-black-50 border-start border-light">
                    <div class="d-flex justify-content-center align-items-center flex-shrink-0 px-3"><i class="fa-regular fa-face-smile"></i></div>
                    <div class="flex-grow-1 mx-2 mt-1">
                        <input type="text" class="form-control py-2 display-7" placeholder="Scrivi un messaggio" v-model="newMessage" @keyup.enter="addMessage">
                    </div>
                    <div class="d-flex justify-content-center align-items-center flex-shrink-0 px-3"><i class="fa-solid fa-microphone"></i></div>
                </div>

            </div>

        </div>
    </div>
    
    <script src="js/script.js"></script>
</body>
</html>